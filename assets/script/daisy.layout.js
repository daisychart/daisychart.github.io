d3.daisy.layout={},d3.daisy.layout.default=function(){function a(a){return"string"==typeof a?{field:a,order:"natural",max:b.dimensionMax}:"object"==typeof a?(a.max||(a.max=b.dimensionMax),a.order||(a.order="natural"),a):void 0}var b={setting:{scale:{},mark:{},axis:{}},width:600,height:500,margin:{top:40,right:55,bottom:48,left:55},data:null,container:null,dimensions:[],measures:[],axes:[],axisTitles:[],grid:!1,tooltip:!0,legend:!0,shape:null,color:null,orient:"vertical",hoverColor:"LemonChiffon",dimensionMax:100,sortByValue:"natural",label:!1,font:d3.daisy.default.font(),customDomain:null},c=!1,d={};return d.color=function(a){return arguments.length?(Array.isArray(a)?b.color=a:"string"==typeof a&&(b.color=[a]),d):b.color},d.condition=function(a){var b,c;for(b=0;b<a.length;b++)if(c=a[b],c.func(d.dimensions(),d.measures()))return c.name;throw d.conditionException()},d.defaultValueLabel=function(a,b,c,e,f){var g=d3.daisy.mark().type("text").name("valueLabel");a&&g.transform(a);var h={pointerEvents:"none"};h.x=b,h.y=c,h.text=e,e&&!e.format&&(h.text.format=function(a){var b;return Math.round(a)!==a?(b=d3.format(".2f")(a),b.length>a.toString().length?a:b):a});var i,j=d.font();for(i in j)j.hasOwnProperty(i)&&(h[i]=j[i]);if(f)for(i in f)f.hasOwnProperty(i)&&(h[i]=f[i]);return g.enter(h),g},d.limit=function(a,c){var e=d3.daisy.transformMethods().set(a,{field:[c.field]});return e=d.sort(e,c.order),c.max||(c.max=b.dimensionMax),e.length>c.max&&(e=e.slice(0,c.max),a=a.filter(function(a){return e.indexOf(a[c.field])>=0})),a},d.sort=function(a,b){return"natural"!==b?d3.daisy.transformMethods().sort(a,{order:b}):a},d.axisTitle=function(a,c){var e=-1,f=0;for(f;f<b.axisTitles.length;f++)if(b.axisTitles[f].name===a){e=f;break}return c?e>=0?b.axisTitles.splice(e,1,{name:a,title:c}):b.axisTitles.push({name:a,title:c}):b.axisTitles.splice(e,1),d},d.defaultDomain=function(a){var b=a.split("."),c=d.axes().filter(function(c){return 1===b.length?b[0]===c.orient:a===c.name});return c.length>0?c[0].scale.defaultDomain()?c[0].scale.defaultDomain():c[0].scale.domain():null},d.axisBase=function(a,c,d){d&&(a.field=d),a.scale||(a.scale=c),a.name||(a.name=a.orient+(a.field?"."+a.field:""));var e,f=b.axisTitles.filter(function(b){var c=b.name.split(".");return c.length<2?c[0]===a.orient:b.name===a.name});return f.length>0&&f[0].title&&(e=f[0].title),d3.daisy.axis().name(a.orient+(a.field?"."+a.field:"")).title(d&&!e?d:e).grid(a.grid).scale(c)},d.axis=function(a){var c;"string"==typeof a?c={orient:a,grid:b.grid}:"object"==typeof a&&(c=a);var e=-1,f=0,g=d.axes();for(f;f<g.length;f++)if(g[f].orient===c.orient&&g[f].field===c.field){e=f;break}return e>=0?g.splice(e,1,c):g.push(c),d},d.axes=function(a){if(!arguments.length)return b.axes.forEach(function(a){a.grid=b.grid}),b.axes;var c=function(a){return"string"==typeof a?{orient:a,title:null,grid:b.grid}:"object"==typeof a?a:void 0};return Array.isArray(a)?b.axes=a.map(function(a){return c(a)}):b.axes=[c(a)],d},d.measures=function(a){if(!arguments.length)return b.measures;var c=function(a){return"string"==typeof a?{field:a,op:"sum"}:"object"==typeof a?a:void 0};return Array.isArray(a)?b.measures=a.map(function(a){return c(a)}):b.measures=[c(a)],d},d.dimensions=function(c){return arguments.length?(Array.isArray(c)||(c=[c]),b.dimensions=c.map(function(b){return a(b)}),d):b.dimensions},d.dimension=function(c){return b.dimensions.push(a(c)),d},d.measure=function(a){return"string"==typeof a?b.measures.push({field:a,op:"sum"}):"object"==typeof a&&b.measures.push(a),d},d.defaultLegend=function(){return{orient:"bottom",font:d3.daisy.default.font()}},d.arrangeDomain=function(a){return 2===a.length&&"[object Date]"!==Object.prototype.toString.call(a[0])&&a[0]<=a[1]&&a[0]*a[1]>0?(a[0]>0?a[0]=0:a[1]=0,a):a},d.size=function(a){return arguments.length?(Array.isArray(a)?b.size={range:a,scale:"linear",reverse:!1}:"number"==typeof a?b.size={range:[a,a],scale:"linear",reverse:!1}:"object"==typeof a&&(b.size=a),d):b.size},d.mixedScale=function(a){var b=!1,c=!1,d="point";a.forEach(function(a){b="number"==typeof a||!isNaN(a)&&+a.toString()===a,c="[object Date]"===Object.prototype.toString.call(a)}),(b||c)&&(a=d3.extent(a),d="linear"),c&&(d="time");var e=d3.daisy.scale().type(d).domain(a);return e},d.scale=function(){return d.setting().scale},d.cScale=function(a,b,c){return arguments.length?d3.daisy.scale().type(b).domain(a).range(d.color()?d.color():c):d.setting().scale.c},d.ordinalCScale=function(a,b){return d.cScale(a,"ordinal",b)},d.linearCScale=function(a,b){return d.cScale(a,"linear",b)},d.margin=function(a){if(!arguments.length)return b.margin;for(var c in a)a.hasOwnProperty(c)&&(b.margin[c]=a[c]);return d},d.defaultMeasureForCount=function(){return{field:"defaultMeasure",op:"count"}},d.conditionException=function(a){function b(){a?this.message=a:this.message="unavailable condtion",this.name="CondtionException"}throw new b},d.zeroPoint=function(a,b){a.domain()[0]*a.domain()[1]<0&&b.zeroPoint(a(0)),a.domain()[0]<=0&&a.domain()[1]<=0&&b.zeroPoint(0)},d.highMarking=function(a,b,c){var e;a.on("mouseenter.highMark",function(a){var f;b.region?(f=b.region.layer().selectAll(".mark."+c),f.each(function(c){var f,g;b.line?(g=c.__melted_key__?"__melted_key__":"c",c[g]===a.toString()&&(f=d3.select(this),f.style("fill-opacity",1))):c.key===a.toString()&&(f=d3.select(this),e=f.node().getAttribute("style").match(/fill:\s(.*?)rgb\((.*?)\);/)[2],f.style("fill",d.hoverColor()))})):(f=b[c].layer().selectAll(".mark"),f.each(function(b){var c;if(c=b.__melted_key__?"__melted_key__":"c",b[c]===a.toString()){var f=d3.select(this);e=f.node().getAttribute("style").match(/fill:\s(.*?)rgb\((.*?)\);/)[2],f.style("fill",d.hoverColor())}}))}).on("mouseleave.highMark",function(a){var d,f;b.region?(d=b.region.layer().selectAll(".mark."+c),d.each(function(c){if(b.line){var d;d=c.__melted_key__?"__melted_key__":"c",c[d]===a.toString()&&(f=d3.select(this),f.style("fill-opacity",0))}else c.key===a.toString()&&(f=d3.select(this),f.style("fill","rgb("+e+")"))})):(d=b[c].layer().selectAll(".mark"),d.each(function(b){var c;if(c=b.__melted_key__?"__melted_key__":"c",b[c]===a.toString()){var d=d3.select(this);d.style("fill","rgb("+e+")")}}))})},d.isXAxis=function(a){return"x"===a.orient},d.isYAxis=function(a){return"y"===a.orient},d.updateFuncs=function(){var a=["_condition","_munge","_frame","_scale","_axis","_mark","_legend","_tooltip","_brush"];return a},d.update=function(){return d.updateFuncs().forEach(function(a){d[a]&&d[a]()}),c=!0,d},d.render=function(){return c||d.updateFuncs().forEach(function(a){d[a]&&d[a]()}),d._render(),c=!1,d},d3.daisy.utils.setAttrDefaultFuncs(d,b),d},d3.daisy.layout.bar=function(){function a(){z.color(u),z.setting({scale:v,mark:w,axis:x}),z._condition=c,z._munge=d,z._frame=e,z._scale=f,z._axis=h,z._mark=g,z._legend=i,z._tooltip=j,z._render=b}function b(){k.render()}function c(){q=z.dimensions(),p=z.measures(),0===q.length&&z.conditionException();var a=y.map(function(a){var b=function(b,c){return"histogram"===a?b.length<=2&&0===c.length:"normal"===a?b.length<=2&&1===c.length:1===b.length};return{name:a,func:b}});l=z.condition(a),"histogram"==l&&(p=[z.defaultMeasureForCount()]),m=z.orient()}function d(){o=z.data(),"mixed"===l&&(o=d3.daisy.transformMethods().aggregate(o,{summarize:p.map(function(a){return a.as=a.field,a}),groupby:q.map(function(a){return a.field})}),o=d3.daisy.transformMethods().melt(o,{groupby:q.map(function(a){return a.field}),field:p.map(function(a){return a.field})})),q.forEach(function(a){o=z.limit(o,a)})}function e(){k=d3.daisy.frame().container(z.container()).width(z.width()).height(z.height()).margin(z.margin()).data(o);var a=z.legend();a&&(n=d3.daisy.legend(),"object"==typeof a?n.orient(a.orient):n.orient(z.defaultLegend().orient),k.legend(n))}function f(){var a=function(a,b){v.x=d3.daisy.scale().type("band").domain(a).padding(z.padding()).round(!0),b?v.x.range([0,v.region.bandwidth()]):"horizontal"===m?v.x.rangeFromFrame([0,"height"],k):v.x.rangeFromFrame([0,"width"],k)},b=function(b,c){var d=d3.daisy.transformMethods().set(o,{field:[b.field]});d=z.sort(d,b.order),a(d,c)},c=function(a,b){var c;c=b&&z.mono()?[a.field]:d3.daisy.transformMethods().set(o,{field:a.field}),c=z.sort(c,a.order),v.c=z.ordinalCScale(c,u)},d=function(a){var b=d3.daisy.transformMethods().set(o,{field:[a.field]});b=z.sort(b,a.order),v.region=d3.daisy.scale().type("band").domain(b).padding(.02).round(!0),"horizontal"===m?v.region.rangeFromFrame([0,"height"],k):v.region.rangeFromFrame([0,"width"],k)},e=function(a,b,c,d){var e;if(b&&r.normalized)e=[0,1];else{if(e=d3.daisy.transformMethods().aggregate(o,{summarize:{field:a.field,op:a.op,as:a.field},groupby:c.map(function(a){return a.field})}),b){var f=d3.daisy.transformMethods().aggregate(e,{summarize:{field:a.field,op:"sum",as:a.field},groupby:[d.field]});e=e.concat(f)}e=d3.daisy.transformMethods().aggregate(e,{summarize:{op:"extent",field:a.field,as:a.field}}),e=e[a.field],e=z.arrangeDomain(e)}return e},f=function(a,b,c,d){var f=e(a,b,c,d);z.customDomain()&&(a.customDomain=z.customDomain()),v.y=z.mixedScale(f).round(!0).defaultDomain(f).customDomain(a.customDomain),"horizontal"===m?v.y.rangeFromFrame([0,"width"],k):v.y.rangeFromFrame([0,"height"],k).reverse(!0)},g=z.stacked(),h=p[0];if("normal"===l||"histogram"===l)2===q.length?(g===!1?(d(q[0]),b(q[1],!0)):b(q[0],!1),c(q[1],!1)):(c(q[0],!0),b(q[0],!1)),f(h,g,q,q[0]);else if("mixed"===l){var i=s;i.order=q[0].order,q=[q[0]],q.push(i),h=t,g===!1?(d(q[0]),b(i,!0)):b(q[0],!1),c(i,!1),f(h,g,q,q[0])}}function g(){function a(a,b,c,d){var e,f,g,h={};return"horizontal"===m?(f={field:a.field,scale:v.x,offset:v.x.bandwidth()/2},e=d?{field:"layout_start"+(r.normalized?"_normalized":""),scale:v.y}:{field:b.field,scale:v.y},e.offset=-2,h.textAnchor={value:"end"},h.dy={value:".35em"}):(e={field:a.field,scale:v.x,offset:v.x.bandwidth()/2},f=d?{field:"layout_start"+(r.normalized?"_normalized":""),scale:v.y}:{field:b.field,scale:v.y},h.textAnchor={value:"middle"},h.dy={value:"1em"}),g=d?{field:"layout_start"+(r.normalized?"_normalized":"")}:{field:b.field},z.defaultValueLabel(c,e,f,g,h)}function b(a,b,c,d){var e=d3.daisy.mark().type("rect").name("bar");c&&e.transform(c);var f={};"horizontal"===m?(f={y:{field:a.field,scale:v.x},height:{scale:v.x,band:!0}},d?(f.x2={field:"layout_start"+(r.normalized?"_normalized":""),scale:v.y},f.x={field:"layout_end"+(r.normalized?"_normalized":""),scale:v.y}):(f.x={value:v.y.domain()[0],scale:v.y},f.width={field:b.field,scale:v.y})):(f={x:{field:a.field,scale:v.x},width:{scale:v.x,band:!0}},d?(f.y={field:"layout_start"+(r.normalized?"_normalized":""),scale:v.y},f.y2={field:"layout_end"+(r.normalized?"_normalized":""),scale:v.y}):(f.y={field:b.field,scale:v.y},f.height={field:b.field,scale:v.y,mult:-1,offset:v.y.range()[0]}));var g={fill:{value:z.hoverColor()}};return e.enter(f).hover(g),e}function c(c,d){var e=d3.daisy.transform().transform({name:"aggregate",options:{groupby:c.field,summarize:{field:d.field,op:d.op,as:d.field}}});w.bar=b(c,d,e),z.mono()?w.bar.update({fill:{value:c.field,scale:v.c}}):w.bar.update({fill:{field:c.field,scale:v.c}}),k.mark(w.bar),z.label()&&(w.label=a(c,d,e),k.mark(w.label))}function d(c,d,e){var f=d3.daisy.transform().transform({name:"facet",options:{groupby:c.field,flatten:!1}});w.region=d3.daisy.group().name("region").transform(f),"horizontal"===m?w.region.enter({y:{field:c.field,scale:v.region}}):w.region.enter({x:{field:c.field,scale:v.region}}),k.mark(w.region);var g=d3.daisy.transform().transform({name:"aggregate",options:{groupby:d.field,summarize:{field:e.field,op:e.op,as:e.field}}});w.bar=b(d,e,g),w.bar.update({fill:{field:d.field,scale:v.c}}),w.region.mark(w.bar),z.label()&&(w.label=a(d,e,g),w.region.mark(w.label))}var e=function(c,d,e){var f=d3.daisy.transform().transform({name:"aggregate",options:{groupby:[c.field,d.field],summarize:{field:e.field,op:e.op,as:e.field}}}).transform({name:"stack",options:{groupby:[d.field],field:e.field,orderby:c.field,normalize:r.normalized}});k.transform(f);var g={fill:{field:d.field,scale:v.c}};w.bar=b(c,e,null,!0),w.bar.update(g),k.mark(w.bar),z.label()&&(w.label=a(c,e,null,!0),k.mark(w.label))},f=z.stacked(),g=p[0];if("normal"===l||"histogram"===l)2===q.length?f?e(q[0],q[1],g):d(q[0],q[1],g):c(q[0],g);else if("mixed"===l){g=t;var h=s;f?e(q[0],h,g):d(q[0],h,g)}}function h(){var a,b,c=z.axes(),d=z.stacked();if(a=q[0].field,"normal"===l?b=p[0].field:"histogram"===l?b="빈도":"mixed"===l&&(b=p.map(function(a){return a.field}).join("-")),c){var e=c.filter(z.isXAxis);e.length>0&&(x.x=z.axisBase(e[0],"mixed"!==l&&2!==q.length||d!==!1?v.x:v.region,a),"horizontal"===m?x.x.orient("left"):x.x.y("height"),k.axis(x.x));var f=c.filter(z.isYAxis);f.length>0&&(x.y=z.axisBase(f[0],v.y,b),"horizontal"===m?x.y.y("height"):x.y.orient("left"),k.axis(x.y))}}function i(){n&&(n.scale(v.c),z.highMarking(n,w,"bar"))}function j(){if(z.tooltip()){var a,b=d3.daisy.tooltip(),c=p[0];2===q.length||"mixed"===l?("mixed"===l?(a=s,c=t):a=q[1],b.keyField(q),z.stacked()?(a=q[0],"horizontal"===m?b.update({y:{field:a.field,scale:v.x},x:{field:"layout_start"+(r.normalized?"_normalized":""),scale:v.y}}):b.update({x:{field:a.field,scale:v.x},y:{field:"layout_start"+(r.normalized?"_normalized":""),scale:v.y}}),k.tooltip(b)):("horizontal"===m?b.update({y:{field:a.field,scale:v.x},x:{field:c.field,scale:v.y}}):b.update({x:{field:a.field,scale:v.x},y:{field:c.field,scale:v.y}}),w.region.tooltip(b))):(a=q[0],b.keyField(a.field),"horizontal"===m?b.update({y:{field:a.field,scale:v.x},x:{field:c.field,scale:v.y}}):b.update({x:{field:a.field,scale:v.x},y:{field:c.field,scale:v.y}}),k.tooltip(b)),b.valueField(c.field),w.bar.on("mouseenter",function(a){b.show(d3.select(this))}),w.bar.on("mouseleave",function(a){b.hide(d3.select(this))})}}var k,l,m,n,o,p,q,r={normalized:!1,stacked:!1,padding:.05,mono:!0},s={field:"__melted_key__",order:"natural"},t={field:"__melted_value__",op:"mean"},u=d3.daisy.default.schemeCategory20(),v={},w={},x={},y=["histogram","normal","mixed"],z=d3.daisy.layout.default();return a(),z.padding=function(a){return arguments.length?(r.padding=Math.max(0,Math.min(a,1)),z):r.padding},d3.daisy.utils.setAttrDefaultFuncs(z,r),z},d3.daisy.layout.line=function(){function a(){A.color(v),A.size(s),A.setting({scale:w,mark:x,axis:y}),A._frame=d,A._condition=c,A._scale=e,A._axis=g,A._mark=f,A._legend=h,A._tooltip=i,A._render=b}function b(){j.render()}function c(){o=A.dimensions(),p=A.measures(),0===o.length&&A.conditionException();var a=z.map(function(a){var b=function(b,c){return"histogram"===a?b.length<=2&&0===c.length:"normal"===a?b.length<=2&&1===c.length:1===b.length};return{name:a,func:b}});k=A.condition(a),"histogram"==k&&(p=[A.defaultMeasureForCount()]),n=A.curve()||"linear"}function d(){m=A.data(),"mixed"===k&&(m=d3.daisy.transformMethods().aggregate(m,{summarize:p.map(function(a){return a.as=a.field,a}),groupby:o.map(function(a){return a.field})}),m=d3.daisy.transformMethods().melt(m,{groupby:o.map(function(a){return a.field}),field:p.map(function(a){return a.field})})),o.forEach(function(a,b){var c=m[0][a.field];0===b&&"number"==typeof c||(m=A.limit(m,a))}),j=d3.daisy.frame().container(A.container()).width(A.width()).height(A.height()).margin(A.margin()).data(m);var a=A.legend();a&&(l=d3.daisy.legend(),"object"==typeof a?l.orient(a.orient):l.orient(A.defaultLegend().orient),j.legend(l))}function e(){var a,b=function(a){var b=d3.daisy.transformMethods().set(m,{field:[a.field]}),c="number";b.forEach(function(a){var b=typeof a;"number"!==b&&(c=b)}),q=c,"natural"===a.order&&"number"===c&&(a.order="ascending"),b=A.sort(b,a.order),w.x=A.mixedScale(b).round(!0).padding(.05).rangeFromFrame([0,"width"],j)},c=function(a,b){var c;c=b?[a.field]:d3.daisy.transformMethods().set(m,{field:a.field}),w.c=A.ordinalCScale(c,v)},d=function(a,b,c,d){var e;if(b&&r.normalized)e=[0,1];else{if(e=d3.daisy.transformMethods().aggregate(m,{summarize:{field:a.field,op:a.op,as:a.field},groupby:c.map(function(a){return a.field})}),b){var f=d3.daisy.transformMethods().aggregate(e,{summarize:{field:a.field,op:"sum",as:a.field},groupby:[d.field]});e=e.concat(f)}e=d3.daisy.transformMethods().aggregate(e,{summarize:{op:"extent",field:a.field,as:a.field}}),e=e[a.field],(b||"area"===A.shape())&&(e=A.arrangeDomain(e))}return e},e=function(a,b,c,e){var f=d(a,b,c,e);A.customDomain()&&(a.customDomain=A.customDomain()),w.y=A.mixedScale(f).rangeFromFrame([0,"height"],j).reverse(!0).round(!0).defaultDomain(f).customDomain(a.customDomain)},f=A.stacked();if("normal"===k||"histogram"===k)a=p[0],2===o.length?(f===!1?b(o[0],!0):b(o[0],!1),c(o[1],!1)):(c(o[0],!0),b(o[0],!1)),e(a,f,o,o[0]);else if("mixed"===k){var g=t;o=[o[0]],o.push(g),a=u,f===!1?b(o[0],!0):b(o[0],!1),c(g,!1),e(a,f,o,o[0])}}function f(){function a(a,b,c,d){var e,f,g={field:a.field,scale:w.x,offset:1};d?(e={field:"layout_start"+(r.normalized?"_normalized":""),scale:w.y},f={field:"layout_start"+(r.normalized?"_normalized":"")}):(e={field:b.field,scale:w.y},f={field:b.field}),e.offset=-1;var h={};return A.defaultValueLabel(c,g,e,f,h)}function b(a,b,c,d){var e=d3.daisy.mark().type("circle").name("point");c&&e.transform(c);var f={x:{field:a.field,scale:w.x},r:{value:1.5*(A.size()?A.size().range[0]:s.range[0])},fillOpacity:{value:r.point?1:0}};return d?f.y={field:"layout_start"+(r.normalized?"_normalized":""),scale:w.y}:f.y={field:b.field,scale:w.y},e.enter(f).hover({fillOpacity:{value:1}}),e}function c(a,b,c,d){var e=A.size();e||(e=s);var f=d3.daisy.mark().type("line").name("line");c&&f.transform(c);var g={x:{field:a.field,scale:w.x},strokeWidth:e.range[0]+"px",strokeLinejoin:"round",fill:"none"};return d?g.y={field:"layout_start"+(r.normalized?"_normalized":""),scale:w.y}:g.y={field:b.field,scale:w.y},f.enter(g),f}function d(a,b,c,d){var e=d3.daisy.mark().type("area").name("area");c&&e.transform(c);var f={x:{field:a.field,scale:w.x}};return d?(f.y={field:"layout_start"+(r.normalized?"_normalized":""),scale:w.y},f.y2={field:"layout_end"+(r.normalized?"_normalized":""),scale:w.y}):(f.y={field:b.field,scale:w.y},f.y2={value:0,scale:w.y}),e.enter(f),e}function e(e,f){var g=d3.daisy.transform().transform({name:"aggregate",options:{groupby:e.field,order:e.order,isSeries:!0,summarize:{field:f.field,op:f.op,as:f.field}}});"area"===A.shape()&&(x.area=d(e,f,g,!1),x.area.update({fill:{value:e.field,scale:w.c},fillOpacity:{value:.5},curve:n}),j.mark(x.area)),x.line=c(e,f,g),x.line.update({stroke:{value:e.field,scale:w.c},curve:n}),j.mark(x.line),x.point=b(e,f,g),x.point.update({fill:{value:e.field,scale:w.c},fillOpacity:{value:r.point?1:0}}),j.mark(x.point),A.label()&&(x.label=a(e,f,g),j.mark(x.label))}function f(e,f,g){var h=d3.daisy.transform().transform({name:"facet",options:{groupby:f.field,flatten:!1}});x.region=d3.daisy.group().name("region").transform(h),j.mark(x.region);var i=d3.daisy.transform().transform({name:"aggregate",options:{groupby:[f.field,e.field],order:e.order,isSeries:!0,summarize:{field:g.field,op:g.op,as:g.field}}});"area"===A.shape()&&(x.area=d(e,g,i,!1),x.area.update({fill:{field:f.field,scale:w.c},fillOpacity:{value:.5},curve:n}),x.region.mark(x.area)),x.line=c(e,g,i),x.line.update({stroke:{field:f.field,scale:w.c},curve:n}),x.region.mark(x.line),x.point=b(e,g,i),x.point.update({fill:{field:f.field,scale:w.c},fillOpacity:{value:r.point?1:0}}),x.region.mark(x.point),A.label()&&(x.label=a(e,g,i),x.region.mark(x.label))}var g,h=function(e,f,g){var h=d3.daisy.transform().transform({name:"aggregate",options:{groupby:[f.field,e.field],order:e.order,isSeries:!0,summarize:{field:g.field,op:g.op,as:g.field}}}).transform({name:"stack",options:{groupby:[f.field],field:g.field,orderby:e.field,order:e.order,normalize:r.normalized}});j.transform(h);var i=d3.daisy.transform().transform({name:"facet",options:{groupby:f.field}});x.region=d3.daisy.group().transform(i).key(f.field),j.mark(x.region),"area"===A.shape()&&(x.area=d(e,g,null,!0),x.area.update({fill:{field:f.field,scale:w.c},fillOpacity:{value:.5},curve:n}),x.region.mark(x.area));var k={stroke:{field:f.field,scale:w.c},curve:n};x.line=c(e,g,null,!0),x.line.update(k),x.region.mark(x.line),x.point=b(e,g,null,!0),x.point.update({fill:{field:f.field,scale:w.c},fillOpacity:{value:r.point?1:0}}),x.region.mark(x.point),A.label()&&(x.label=a(e,g,null,!0),x.region.mark(x.label))},i=A.stacked();if("normal"===k||"histogram"===k)g=p[0],2===o.length?i?h(o[0],o[1],g):f(o[0],o[1],g):e(o[0],g);else if("mixed"===k){g=u;var l=t;i?h(o[0],l,g):f(o[0],l,g)}}function g(){var a,b=A.axes(),c=(A.stacked(),A.dimensions()[0].field);if("normal"===k?a=A.measures()[0].field:"histogram"===k?a="빈도":"mixed"===k&&(a=p.map(function(a){return a.field}).join("-")),b){var d=b.filter(A.isXAxis);d.length>0&&(y.x=A.axisBase(d[0],w.x,c).y("height"),A.zeroPoint(w.y,y.x),j.axis(y.x));var e=b.filter(A.isYAxis);e.length>0&&(y.y=A.axisBase(e[0],w.y,a).orient("left"),j.axis(y.y))}}function h(){A.legend()&&(l.scale(w.c),A.highMarking(l,x,"point"))}function i(){if(A.tooltip()){var a=d3.daisy.tooltip(),b=[];b.push(o[0]);var c,d;"mixed"===k?(c=u,b.push(c)):(c=p[0],b.push(c)),a.valueField(b),2===o.length||"mixed"===k?(d=o[0],a.keyField(o[1].field),A.stacked()?(a.update({x:{field:d.field,scale:w.x},y:{field:"layout_start"+(r.normalized?"_normalized":""),scale:w.y}}),j.tooltip(a)):(a.update({x:{field:d.field,scale:w.x,offset:8},y:{field:c.field,scale:w.y}}),j.tooltip(a))):(d=o[0],a.update({x:{field:d.field,scale:w.x,offset:8},y:{field:c.field,scale:w.y}}),j.tooltip(a)),x.point.on("mouseenter",function(b){a.show(d3.select(this))}),x.point.on("mouseleave",function(b){a.hide(d3.select(this))})}}var j,k,l,m,n,o,p,q,r={normalized:!1,stacked:!1,curve:null,point:!1},s={range:[2,2],scale:"linear",reverse:!1},t={field:"__melted_key__",order:"natural"},u={field:"__melted_value__",op:"mean"},v=d3.daisy.default.schemeCategory10(),w={},x={},y={},z=["histogram","normal","mixed"],A=d3.daisy.layout.default();return a(),d3.daisy.utils.setAttrDefaultFuncs(A,r),A},d3.daisy.layout.scatter=function(){function a(){w.color(r),w.size(q),w.setting({scale:s,mark:t,axis:u}),w._frame=d,w._condition=c,w._scale=e,w._axis=g,w._mark=f,w._legend=h,w._tooltip=i,w._render=b}function b(){j.render()}function c(){o=w.dimensions(),n=w.measures(),n.length<2&&w.conditionException();var a=v.map(function(a){var b=function(b,c){return"normal"===a?0===b.length&&2===c.length:"color"===a?1===b.length&&2===c.length:"bubble"===a?0===b.length&&3===c.length:"mixed"===a?1===b.length&&3===c.length:void 0};return{name:a,func:b}});k=w.condition(a)}function d(){m=w.data(),o.length>=1&&o.forEach(function(a){m=w.limit(m,a)}),j=d3.daisy.frame().container(w.container()).width(w.width()).height(w.height()).margin(w.margin()).data(m);var a=w.legend();"color"!==k&&"mixed"!==k||!a||(l=d3.daisy.legend(),"object"==typeof a?l.orient(a.orient):l.orient(w.defaultLegend().orient),j.legend(l))}function e(){var a=function(a){var b=c(a);w.customDomain()&&w.customDomain()[0]&&(a.customDomain=w.customDomain()[0]),s.x=w.mixedScale(b).round(!0).rangeFromFrame([0,"width"],j).defaultDomain(b).customDomain(a.customDomain)},b=function(a){var b=d3.daisy.transformMethods().set(m,{field:a.field});s.c=w.ordinalCScale(b,r)},c=function(a){var b=d3.daisy.transformMethods().aggregate(m,{summarize:{op:"extent",field:a.field,as:a.field}});return b=b[a.field]},d=function(a){var b=c(a);w.customDomain()&&w.customDomain()[1]&&(a.customDomain=w.customDomain()[1]),s.y=w.mixedScale(b).rangeFromFrame([0,"height"],j).reverse(!0).round(!0).defaultDomain(b).customDomain(a.customDomain)},e=function(a){var b=w.size();b||(b=q);var c=d3.daisy.transformMethods().aggregate(m,{summarize:{op:"extent",field:a.field,as:a.field}});c=c[a.field],s.r=d3.daisy.scale().type(b.scale).domain(c).range(b.range).reverse(b.reverse)};a(n[0]),d(n[1]),"mixed"!==k&&"color"!==k||b(o[0]),"mixed"!==k&&"bubble"!==k||e(n[2])}function f(){var a=w.color()[0],b=w.size();b||(b=q),t.point=d3.daisy.mark().type("circle").name("point");var c={x:{field:n[0].field,scale:s.x},y:{field:n[1].field,scale:s.y},r:{value:b.range[0]},fillOpacity:.5,fill:{value:a},stroke:{value:a}};"mixed"!==k&&"color"!==k||(c.fill={field:o[0].field,scale:s.c},c.stroke={field:o[0].field,scale:s.c}),"mixed"!==k&&"bubble"!==k||(c.r={field:n[2].field,scale:s.r}),t.point.enter({strokeWidth:1}).update(c).hover({fillOpacity:{value:1}}),j.mark(t.point),w.label()&&(t.label=w.defaultValueLabel(null,{field:n[0].field,scale:s.x,offset:1},{field:n[1].field,scale:s.y,offset:-1},{callback:function(a){return a[n[0].field]+", "+a[n[1].field]+("mixed"===k||"bubble"===k?", "+a[n[2].field]:"")}}),j.mark(t.label))}function g(){var a=w.axes(),b=w.measures()[0].field,c=w.measures()[1].field;if(a){var d=a.filter(w.isXAxis);d.length>0&&(u.x=w.axisBase(d[0],s.x,b).y("height"),w.zeroPoint(s.y,u.x),j.axis(u.x));var e=a.filter(w.isYAxis);e.length>0&&(u.y=w.axisBase(e[0],s.y,c).orient("left"),j.axis(u.y))}}function h(){l&&(l.scale(s.c),w.highMarking(l,t,"point"))}function i(){if(w.tooltip()){var a=d3.daisy.tooltip().moveToFront(!1);a.keyField(o[0]).valueField(n).update({x:{field:n[0].field,scale:s.x,offset:2*q.range[0]},y:{field:n[1].field,scale:s.y}}),t.point.on("mouseenter",function(b){a.show(d3.select(this))}),t.point.on("mouseleave",function(b){a.hide(d3.select(this))})}}var j,k,l,m,n,o,p={},q={range:[3,12],scale:"linear",reverse:!1},r=d3.daisy.default.schemeCategory10(),s={},t={},u={},v=["normal","color","bubble","mixed"],w=d3.daisy.layout.default();return a(),d3.daisy.utils.setAttrDefaultFuncs(w,p),w},d3.daisy.layout.parCoords=function(){function a(){z.color(x),z.size(w),z.setting({scale:r,mark:s,axis:t}),z._frame=d,z._condition=c,z._scale=e,z._axis=g,z._mark=f,z._legend=i,z._tooltip=j,z._brush=h,z._render=b}function b(){k.render()}function c(){o=z.dimensions(),p=z.measures(),p.length<2&&z.conditionException();var a=v.map(function(a){var b=function(b,c){return"normal"===a?0===b.length:"color"===a?1===b.length:void 0};return{name:a,func:b}});l=z.condition(a)}function d(){n=z.data(),o.length>=1&&o.forEach(function(a){n=z.limit(n,a)}),k=d3.daisy.frame().container(z.container()).width(z.width()).height(z.height()).margin(z.margin()).data(n);var a=z.legend();"color"==l&&a&&(m=d3.daisy.legend(),"object"==typeof a?m.orient(a.orient):m.orient(z.defaultLegend().orient),k.legend(m))}function e(){var a,b=function(a){var b=d3.daisy.scale().type("point").domain(a).round(!0).padding(.01).rangeFromFrame([0,"width"],k);r.x=b},c=function(a){var c=a.map(function(a){return a.field});b(c)},d=function(a){var b=d3.daisy.transformMethods().set(n,{field:a.field});b=z.sort(b,a.order),r.c=z.ordinalCScale(b,x)},e=function(a,b){var c=n;return b&&(c=d3.daisy.transformMethods().aggregate(c,{summarize:{field:a.field,op:a.op,as:a.field},groupby:b.field})),c=d3.daisy.transformMethods().aggregate(c,{summarize:{op:"extent",field:a.field,as:a.field}}),c=c[a.field]},f=function(a,b){var c=e(a,b);r[y+a.field]=z.mixedScale(c).rangeFromFrame([0,"height"],k).reverse(!0).round(!0).defaultDomain(c).customDomain(a.customDomain)};"color"==l&&(a=o[0],d(a)),c(p),p.forEach(function(b){f(b,a)})}function f(){var a=d3.daisy.transform(),b=z.size()||w,c={opacity:1,stroke:{value:d3.daisy.default.schemeCategory10()[0]},strokeWidth:{value:b.range[0]+"px"},x:{field:"__layout_key__",scale:r.x},y:{field:"__layout_scaled_value__"}};if("color"===l){var d=z.dimensions()[0],e={groupby:d.field};e.summarize=p.map(function(a){return a.as=a.field,a}),a.transform({name:"aggregate",options:e}),c.stroke={field:d.field,scale:r.c}}a.transform({name:"parCoords",options:{groupby:r.x.domain(),scale:r}}),k.transform(a),s.region=d3.daisy.group().name("region").update({opacity:1}).hide({opacity:.2}),k.mark(s.region),s.line=d3.daisy.mark().type("line").name("line"),s.line.enter({fill:"none"}).update(c),s.region.mark(s.line)}function g(){var a=z.axes();if(a){var b=a.filter(z.isYAxis);b.length>0&&p.forEach(function(a){var b=[y+a.field],c={orient:"y",field:a.field};z.axis(c),t[b]=z.axisBase(c,r[b],a.field).x(r.x(a.field)).orient("left").titleAnchor("end"),k.axis(t[b])})}}function h(){if(z.brush()&&z.axes()){var a={},b=function(){var b;return s.region.hideAndShow(function(c){var d=function(a){return a.__layout_key__===b};for(b in a)if(a.hasOwnProperty(b)){var e=a[b],f=c.filter(d);if(f&&(f=f[0][b]),f<e[1]||f>e[0])return!0}return!1})};p.forEach(function(c,d){var e=[y+c.field],f=r[e],g=r.x(c.field);u[e]=d3.daisy.brush().type("y").yScale(f).extent([[g-q.brushW/2,f.range()[1]],[g+q.brushW/2,f.range()[0]]]),k.brush(u[e]),u[e].on("brush",function(){var d=u[e].domain();a[c.field]=d,b()}),u[e].on("end",function(){u[e].hasSelection()||(delete a[c.field],b())})})}}function i(){m&&m.scale(r.c)}function j(){!z.tooltip()||"normal"===l}var k,l,m,n,o,p,q={brush:!0,brushW:28},r={},s={},t={},u={},v=["normal","color"],w={range:[1,1],scale:"linear",reverse:!1},x=d3.daisy.default.schemeCategory20(),y="__scale_y_",z=d3.daisy.layout.default();return a(),d3.daisy.utils.setAttrDefaultFuncs(z,q),z},d3.daisy.layout.pie=function(){function a(){v.color(q),v.size(p),v.setting({scale:r,mark:s,axis:t}),v._frame=d,v._condition=c,v._scale=e,v._mark=f,v._legend=g,v._tooltip=h,v._render=b}function b(){i.render()}function c(){m=v.dimensions(),n=v.measures(),m.length<1&&v.conditionException();var a=u.map(function(a){var b=function(b,c){return"normal"===a?1===b.length&&1===c.length:"histogram"===a?1===b.length&&0===c.length:void 0};return{name:a,func:b}});j=v.condition(a),"histogram"===j&&(n=[v.defaultMeasureForCount()])}function d(){l=v.data(),m.forEach(function(a){l=v.limit(l,a)}),i=d3.daisy.frame().container(v.container()).width(v.width()).height(v.height()).margin(v.margin()).data(l);var a=v.legend();a&&(k=d3.daisy.legend(),"object"==typeof a?k.orient(a.orient):k.orient(v.defaultLegend().orient),i.legend(k))}function e(){var a=function(a){var b=d3.daisy.transformMethods().set(l,{field:a.field});b=v.sort(b,a.order),r.c=v.ordinalCScale(b,q)},b=v.dimensions()[0];a(b)}function f(){var a=v.size();a||(a=p),s.pie=d3.daisy.mark().type("arc").name("pie");var b=d3.daisy.transform(),c=n[0],d=m[0];if(b.transform({name:"aggregate",options:{groupby:d.field,summarize:{field:c.field,op:c.op,as:c.field}}}),"natural"!==d.order?b.transform({name:"sort",options:{orderby:d.field,order:d.order}}):b.transform({name:"sort",options:{orderby:d.field,orderList:r.c.domain()}}),b.transform({name:"pie",options:{field:c.field}}),s.pie.enter({x:{value:.5*i.innerWidth()},y:{value:.5*i.innerHeight()},innerRadius:{value:a.range[0]},outerRadius:{value:a.range[1]}}).update({startAngle:{field:"layout_start"},endAngle:{field:"layout_end"},fill:{field:m[0].field,scale:r.c}}),i.transform(b).mark(s.pie),v.label()){var e=.5*Math.PI,f=d3.mean(a.range),g=.5*i.innerWidth(),h=.5*i.innerHeight();s.label=v.defaultValueLabel(null,{callback:function(a){return Math.cos(a.layout_middle-e)*f+g}},{callback:function(a){return Math.sin(a.layout_middle-e)*f+h}},{field:c.field},{dy:".35em",textAnchor:"middle"}),i.mark(s.label)}}function g(){k&&(k.scale(r.c),v.highMarking(k,s,"pie"))}function h(){if(v.tooltip()){var a=d3.daisy.tooltip().moveToFront(!1).center(!0),b=v.size();b||(b=p);var c=n[0],d=.5*Math.PI,e=d3.mean(b.range),f=.5*i.innerWidth(),g=.5*i.innerHeight();a.keyField(m[0].field).valueField(c.field).update({x:{callback:function(a){return Math.cos(a.layout_middle-d)*e+f}},y:{callback:function(a){return Math.sin(a.layout_middle-d)*e+g}}}),s.pie.on("mouseenter",function(b){a.show(d3.select(this))}),s.pie.on("mouseleave",function(b){a.hide(d3.select(this))})}}var i,j,k,l,m,n,o={},p={range:[0,150],scale:"linear",reverse:!1},q=d3.daisy.default.schemeCategory10(),r={},s={},t={},u=["normal","histogram"],v=d3.daisy.layout.default();return v.dimensionMax(40),a(),d3.daisy.utils.setAttrDefaultFuncs(v,o),v},d3.daisy.layout.treemap=function(){function a(){D.color(C),D.setting({scale:v,mark:w,axis:x}),D._condition=c,D._munge=d,D._frame=e,D._scale=f,D._mark=g,D._legend=h,D._tooltip=i,D._render=b}function b(){
n.render()}function c(){s=D.dimensions(),t=D.measures(),0===s.length&&D.conditionException();var a=y.map(function(a){var b=function(b,c){return"histogram"===a?0===c.length:"normal"===a?1===c.length:1===b.length};return{name:a,func:b}});o=D.condition(a),"histogram"===o&&(t=[D.defaultMeasureForCount()]),z=s.length,r=D.shape()||"treemap","word"===r&&s.length>1&&D.conditionException()}function d(){q=D.data(),s.length>=1&&s.forEach(function(a){q=D.limit(q,a)}),q=d3.daisy.transformMethods().aggregate(q,{groupby:s.map(function(a){return a.field}),summarize:{field:t[0].field,op:t[0].op,as:t[0].field}})}function e(){n=d3.daisy.frame().container(D.container()).width(D.width()).height(D.height()).margin(D.margin()).data(q);var a=D.legend();a&&(p=d3.daisy.legend(),"object"==typeof a?p.orient(a.orient):p.orient(D.defaultLegend().orient),"normal"===o?p.gradientTitle(t[0].field):p.gradientTitle("빈도"),n.legend(p))}function f(){var a=function(a,b){var c=d3.daisy.transformMethods().aggregate(q,{summarize:{field:b.field,op:"extent",as:"extent"}});c=c.extent,v.c=D.linearCScale(c,C)};a(s,t[0])}function g(){"treemap"===r?l(s,t[0]):"pack"===r?m(s,t[0]):"word"===r&&k(s[0],t[0])}function h(){if(p){p.scale(v.c);var a=function(a){p.showPointer(a)},b=function(){p.hidePointer()};for(var c in w)w.hasOwnProperty(c)&&c.startsWith("node")&&(w[c].on("mouseenter.pointer",a),w[c].on("mouseleave.pointer",b))}}function i(){if(D.tooltip()){var a=d3.daisy.tooltip();a.keyField({callback:function(a){return a.data.key}}).valueField("value"),"treemap"===r||"word"===r?a.update({x:{field:"x0"},y:{field:"y0"}}):a.update({x:{field:"x"},y:{field:"y"}});var b=function(b){a.show(d3.select(this))},c=function(){a.hide(d3.select(this))};for(var d in w)w.hasOwnProperty(d)&&d.startsWith("node")&&(w[d].on("mouseenter",b),w[d].on("mouseleave",c))}}function j(a,b){b=b||"treemap";var c=[n.innerWidth(),n.innerHeight()];D.size()&&(c=[Math.min(D.size().range[0],n.innerWidth()),Math.min(D.size().range[1],n.innerHeight())]);var d={size:c,isRoot:!1,children:"values",field:a.field,order:"natural"!==D.sortByValue()?D.sortByValue():null};"treemap"===b?(d.round=!0,d.paddingTop=A,d.padding=1):"pack"===b?d.padding=2:"word"===b&&(d.round=!0);var e=d3.daisy.transform().transform({name:"facet",options:{flatten:!1,groupby:s.map(function(a){return a.field})}}).transform({name:"word"===b?"treemap":b,options:d});n.transform(e)}function k(a,b){j(b,"word"),w.node=d3.daisy.mark().type("text").name("leaf node").enter({fontFamily:B.fontFamily,fontWeight:B.fontWeight,x:{field:"x0"},y:{field:"y0"},lengthAdjust:"spacingAndGlyphs",text:{callback:function(a){return a.data.key}},fontSize:{callback:function(a){return a.vertical?a.w-1:a.h-1}},textLength:{callback:function(a){return a.vertical?a.h:a.w}},transform:{callback:function(a){var b=d3.select(this).attr("transform");return a.vertical?(b?b:"")+"rotate(90)":b}},dy:{callback:function(a){return a.vertical?"-.1em":".71em"}}}).update({fill:{field:"value",scale:v.c}}).hover({ill:{value:D.hoverColor()}}),n.mark(w.node)}function l(a,b){j(b,"treemap");var c=n,d=20;a.forEach(function(a,b){if(b+1===z)w.node=d3.daisy.mark().type("rect").name("leaf node").enter({x:{field:"x0"},y:{field:"y0"},width:{field:"w"},height:{field:"h"}}).update({fill:{field:"value",scale:v.c}}).hover({fill:{value:D.hoverColor()}}),w.namelabel=d3.daisy.mark().type("text").name("leaf label").enter({text:{callback:function(a){return a.data.key}},fontFamily:B.fontFamily,fontSize:B.fontSize,dx:"2px",dy:"1em",fontWeight:"bold",pointerEvents:"none"}).update({x:{field:"x0"},y:{field:"y0"},opacity:{callback:function(a){var b=this.getBBox().width;return a.w<=b+2?0:a.h<=d-2?0:1}}}),c.mark(w.node),c.mark(w.namelabel),D.label()&&(w.valueLabel=D.defaultValueLabel(null,{field:"x0"},{field:"y0"},{field:"value"},{dx:"2px",dy:"2.17em",opacity:{callback:function(a){var b=this.getBBox().width;return a.w<=b+2?0:a.h<=d+12?0:1}}}),c.mark(w.valueLabel));else if(b+1<z){var e="region_"+b,f="node_"+b+"_label",g="node_"+b+"_rect";w[e]=d3.daisy.group().name("node").field("children"),w[f]=d3.daisy.mark().type("text").name("label").enter({text:{callback:function(a){return a.data.key}},fontFamily:B.fontFamily,fontSize:B.fontSize,dx:"2px",dy:"1em",fontWeight:"bold",pointerEvents:"none"}).update({x:{field:"x0"},x2:{field:"x1"},y:{field:"y0"},y2:{field:"y1"},opacity:{callback:function(a){var b=this.getBBox().width;return a.x1-a.x0<=b+2?0:a.y1-a.y0<=d?0:1}}}),w[g]=d3.daisy.mark().type("rect").name("background").enter({x:{field:"x0"},x2:{field:"x1"},y:{field:"y0"},height:A,stroke:"#ddd",strokeWidth:.5}).update({fill:"#eee"}).hover({ill:{value:D.hoverColor()}}),c.mark(w[e]),c.mark(w[g]),c.mark(w[f]),c=w[e]}})}function m(a,b){j(b,"pack");var c=n;a.forEach(function(a,b){var d="node_"+b+"_circle";b+1===z&&(d="node"),w[d]=d3.daisy.mark().type("circle").name("node");var e={x:{field:"x"},y:{field:"y"},r:{field:"r"}};if(b+1===z)e.fill={field:"value",scale:v.c},c.mark(w[d]),w.namelabel=d3.daisy.mark().type("text").name("leaf label").enter({text:{callback:function(a){return a.data.key}},fontFamily:B.fontFamily,fontSize:B.fontSize,textAnchor:"middle",dy:".35em",pointerEvents:"none",fontWeight:"bold"}).update({x:{field:"x"},y:{field:"y"},opacity:{callback:function(a){var b=this.getBBox().width;return 2*a.r<=b?0:1}}}),c.mark(w.namelabel);else if(b+1<z){var f="region_"+b;w[f]=d3.daisy.group().name("node").field("children"),e.fill={value:"#eee"},e.stroke={value:"#ccc"},e.strokeWidth="1px",c.mark(w[d]),c.mark(w[f]),c=w[f]}w[d].update(e).hover({ill:{value:D.hoverColor()}})})}var n,o,p,q,r,s,t,u={},v={},w={},x={},y=["histogram","normal"],z=0,A=18,B=d3.daisy.default.font(),C=d3.daisy.default.schemeLinear2(),D=d3.daisy.layout.default();return a(),d3.daisy.utils.setAttrDefaultFuncs(D,u),D},d3.daisy.layout.markerMap=function(){function a(){y.color(r),y.size(q),y.setting({scale:u,mark:v,axis:w}),y._frame=c,y._condition=b,y._render=g}function b(){n=y.dimensions(),o=y.measures(),n.length>2&&y.conditionException(),p.addr?2==o.length?j="normal":1==o.length?j="point":y.conditionException():3==o.length?j="normal":2==o.length?j="point":y.conditionException()}function c(){m=y.data();var a=y.width(),b=y.height();y.margin();i=d3.select(y.container()).style("width",a+"px").style("height",b+"px"),i.call(d)}function d(a){var b={center:new daum.maps.LatLng(33.450701,126.570667),level:3};k=new daum.maps.Map(a.node(),b),k.setMapTypeId(daum.maps.MapTypeId[p.mapBaseType]),k.setZoomable(!1),p.overlayMapType&&k.addOverlayMapTypeId(daum.maps.MapTypeId[p.overlayMapType]);var c=new daum.maps.ZoomControl;return k.addControl(c,daum.maps.ControlPosition.RIGHT),l=new daum.maps.services.Geocoder,a}function e(a,b){l.addr2coord(a,function(a,c){return a===daum.maps.services.Status.OK?b(null,c.addr[0]):b(a)})}function f(a,b,c,d,e){var f=k.getLevel(),g=d3.format(".2f"),h=d3.format(".2f"),i=111111,l=y.size();l||(l=q);var m="normal"===j?u.r(Math.pow(a[d.field],.5)):l.range[0]*Math.pow(2,f),n={clickable:!0,zIndex:10,center:a.__latLng__,radius:m};x.forEach(function(a){n[a]=p[a]}),y.color()&&(n.fillColor=y.color()[0],n.strokeColor=y.color()[0]);var r=new daum.maps.Circle(n);if(r.setMap(k),p.showCenter){var s=new daum.maps.Circle({center:a.__latLng__,radius:u.r.range()[0]/4,fillColor:p.strokeColor,fillOpacity:p.strokeOpacity,strokeWeight:0});s.setMap(k)}var t=e?a[e.field]:p.addr?a[o[0].field]:"위도: "+h(a[o[0].field])+"</br> 경도: "+h(a[o[1].field]),v='<div class="daisy-chart-tooltip" style="padding:4px;font-size:12px;font-family:sans-serif;"><div class="daisy-chart-key" style="font-weight:bold;">'+t+"</div>"+("normal"==j&&d?'<div class="daisy-chart-value">'+(d.field?d.field+": ":"")+g(a[d.field])+"</div>":"")+"</div>",w=new daum.maps.InfoWindow({position:new daum.maps.LatLng(a[b.field]+m/i,a[c.field]),content:v});daum.maps.event.addListener(r,"mouseover",function(){w.open(k)}),daum.maps.event.addListener(r,"mouseout",function(){w.close()});var z,A;y.label()&&d&&(A=h(a[d.field]),z=new daum.maps.CustomOverlay({position:a.__latLng__,clickable:!0,zIndex:-1,content:'<div class="label" style="pointer-events:none;padding:4px;font-size:12px;font-family:sans-serif;">'+A+"</div>"}),z.setMap(k))}function g(){var a,b,c=y.size();c||(c=q);var d=function(d){d.forEach(function(c){c.__latLng__=new daum.maps.LatLng(c[a.field],c[b.field])});var e=new daum.maps.LatLngBounds;d.forEach(function(a){e.extend(a.__latLng__)}),k.setBounds(e);var f=k.getLevel();if("normal"===j){var g;u.r=d3.scaleLinear().clamp(!0),g=p.addr?o[1]:o[2];var h=Math.pow(2,f),i=d3.extent(d.map(function(a){return Math.pow(a[g.field],.5)}));u.r.domain(i).range([c.range[0]*h,c.range[1]*h])}};if(p.addr){var f=0;a=s,b=t;var g=function(c,i){if(c)throw"CAN NOT FIND COORDS";m[f][a.field]=i.lat,m[f][b.field]=i.lng,f+=1,f<m.length?e(m[f][o[0].field],g):(d(m),h())};e(m[f][o[0].field],g)}else a=o[0],b=o[1],d(m),h()}function h(){var a,b,c,d=n[0];p.addr?(a=s,b=t,c=o[1]):(a=o[0],b=o[1],c=o[2]),"normal"===j&&m.sort(function(a,b){return b[c.field]-a[c.field]}),m.forEach(function(e){f(e,a,b,c,d)})}var i,j,k,l,m,n,o,p={addr:!1,strokeWeight:1.5,strokeColor:"#75B8FA",strokeOpacity:1,strokeStyle:"solid",fillColor:"#75B8FA",fillOpacity:.5,mapBaseType:"ROADMAP",overlayMapType:null},q={range:[.5,4],scale:"linear",reverse:!1},r=[p.strokeColor],s={field:"__lat__"},t={field:"__lng__"},u={},v={},w={},x=["strokeWeight","strokeColor","strokeOpacity","strokeStyle","fillColor","fillOpacity"],y=d3.daisy.layout.default();return a(),d3.daisy.utils.setAttrDefaultFuncs(y,p),y},d3.daisy.layout.xyHeatmap=function(){function a(){w.color(r),w.setting({scale:s,mark:t,axis:u}),w._condition=c,w._munge=d,w._frame=e,w._scale=f,w._axis=g,w._legend=i,w._mark=h,w._tooltip=j,w._render=b}function b(){k.render()}function c(){p=w.dimensions(),o=w.measures(),2!==p.length&&w.conditionException(),0===o.length?(l="histogram",o=[w.defaultMeasureForCount()]):1===o.length?l="normal":w.conditionException("Measures are too many.");var a=v.map(function(a){var b=function(b,c){return"normal"===a?1===c.length:"histogram"===a?0===c.length:void 0};return{name:a,func:b}});l=w.condition(a),"histogram"===l&&(o=[w.defaultMeasureForCount()])}function d(){n=w.data();w.axes().filter(w.isXAxis),w.axes().filter(w.isYAxis);p.forEach(function(a){n=w.limit(n,a)});var a=o[0];a.as=a.field,n=d3.daisy.transformMethods().aggregate(n,{summarize:[a],groupby:p.map(function(a){return a.field}),flatten:!0})}function e(){k=d3.daisy.frame().container(w.container()).width(w.width()).height(w.height()).margin(w.margin()).data(n);var a=w.legend();a&&(m=d3.daisy.legend(),"object"==typeof a?m.orient(a.orient):m.orient(w.defaultLegend().orient),"normal"===l?m.gradientTitle(o[0].field):m.gradientTitle("빈도"),k.legend(m))}function f(){function a(a){var b=d3.daisy.transformMethods().set(n,{field:[a.field]});return b=w.sort(b,a.order),d3.daisy.scale().type("band").domain(b).padding(.05).round(!0)}var b,c=function(a,b){var c=d3.daisy.transformMethods().aggregate(n,{summarize:{field:b.field,op:"extent",as:"extent"}});return c=c.extent,w.linearCScale(c,r)};b="histogram"===l?w.defaultMeasureForCount():o[0],s.c=c(p,b),s.x=a(p[0]),s.y=a(p[1]),w.reverse()?(s.x.rangeFromFrame([0,"height"],k),s.y.rangeFromFrame([0,"width"],k)):(s.x.rangeFromFrame([0,"width"],k),s.y.rangeFromFrame([0,"height"],k))}function g(){var a=w.axes(),b=p[0].field,c=p[1].field;if(a){var d=a.filter(w.isXAxis);d.length>0&&(u.x=w.axisBase(d[0],s.x,b),w.reverse()?u.x.orient("left"):u.x.y("height"),k.axis(u.x));var e=a.filter(w.isYAxis);e.length>0&&(u.y=w.axisBase(e[0],s.y,c),w.reverse()?u.y.y("height"):u.y.orient("left"),k.axis(u.y))}}function h(){var a,b=o[0];a=w.reverse()?{x:{field:p[1].field,scale:s.y},y:{field:p[0].field,scale:s.x},width:{scale:s.y,band:!0},height:{scale:s.x,band:!0}}:{x:{field:p[0].field,scale:s.x},y:{field:p[1].field,scale:s.y},width:{scale:s.x,band:!0},height:{scale:s.y,band:!0}},t.bar=d3.daisy.mark().type("rect").name("node"),t.bar.enter(a).update({fill:{field:b.field,scale:s.c}}).hover({fill:{value:w.hoverColor()}}),k.mark(t.bar),w.label()&&(t.label=w.defaultValueLabel(null,{field:p[0].field,scale:s.x},{field:p[1].field,scale:s.y},{field:b.field},{dy:"1em",dx:"2px"}),k.mark(t.label))}function i(){m&&(m.scale(s.c),t.bar.on("mouseenter.pointer",function(a){m.showPointer(a,o[0].field)}),t.bar.on("mouseleave.pointer",function(){m.hidePointer()}))}function j(){if(w.tooltip()){var a,b=d3.daisy.tooltip();a=w.reverse()?{x:{field:p[1].field,scale:s.y},y:{field:p[0].field,scale:s.x}}:{y:{field:p[1].field,scale:s.y},x:{field:p[0].field,scale:s.x}};var c;c=o[0],b.valueField(c),b.keyField(p),b.update(a),t.bar.on("mouseenter",function(a){b.show(d3.select(this))}),t.bar.on("mouseleave",function(a){b.hide(d3.select(this))})}}var k,l,m,n,o,p,q={reverse:!1},r=d3.daisy.default.schemeLinear2(),s={},t={},u={},v=["normal","histogram"],w=d3.daisy.layout.default();return a(),d3.daisy.utils.setAttrDefaultFuncs(w,q),w},d3.daisy.layout.combo=function(){function a(){x.color(w),x.size(v),x.setting({scale:r,mark:s,axis:t}),x._condition=c,x._munge=d,x._frame=e,x._scale=f,x._axis=h,x._legend=j,x._mark=g,x._tooltip=i,x._render=b}function b(){k.render()}function c(){p=x.dimensions(),o=x.measures();var a=u.map(function(a){return{name:a,func:function(a,b){return 2===b.length&&1===a.length}}});l=x.condition(a)}function d(){n=x.data(),p.forEach(function(a){n=x.limit(n,a)})}function e(){k=d3.daisy.frame().container(x.container()).width(x.width()).height(x.height()).margin(x.margin()).data(n);var a=x.legend();a&&(m=d3.daisy.legend(),"object"==typeof a?m.orient(a.orient):m.orient(x.defaultLegend().orient),k.legend(m))}function f(){var a=d3.daisy.transformMethods().set(n,{field:[p[0].field]});a=x.sort(a,p[0].order),r.x=d3.daisy.scale().type("band").domain(a).padding(x.padding()).round(!0).rangeFromFrame([0,"width"],k);var b=function(a,b,c){var d=d3.daisy.transformMethods().aggregate(n,{summarize:{field:a.field,op:a.op,as:a.field},groupby:[b.field]});return d=d3.daisy.transformMethods().aggregate(d,{summarize:{op:"extent",field:a.field,as:a.field}}),d=d[a.field],c&&(d=x.arrangeDomain(d)),d},c=b(o[0],p[0],!0);x.customDomain()&&x.customDomain()[0]&&(o[0].customDomain=x.customDomain()[0]),r.yBar=x.mixedScale(c).round(!0).rangeFromFrame([0,"height"],k).reverse(!0).defaultDomain(c).customDomain(o[0].customDomain);var d=b(o[1],p[0],!1);x.customDomain()&&x.customDomain()[1]&&(o[1].customDomain=x.customDomain()[1]),r.yLine=x.mixedScale(d).rangeFromFrame([0,"height"],k).reverse(!0).round(!0).defaultDomain(d).customDomain(o[1].customDomain),r.c=x.ordinalCScale(o.map(function(a){return a.field}),w)}function g(){function a(a,b,c,d){var e,f,g,h={};return e={field:a.field,scale:r.x,offset:r.x.bandwidth()/2},f={field:b.field,scale:d?r.yBar:r.yLine},d?(h.textAnchor={value:"middle"},h.dy={value:"1em"}):(h.textAnchor={value:"start"},e.offset+=1,f.offset=-1),g={field:b.field},x.defaultValueLabel(c,e,f,g,h)}var b=p[0],c=o[0],d=o[1],e=x.size()||v,f=d3.daisy.transform().transform({name:"aggregate",options:{groupby:b.field,summarize:{field:c.field,op:c.op,as:c.field}}}),g=d3.daisy.transform().transform({name:"aggregate",options:{groupby:b.field,summarize:{field:d.field,op:d.op,as:d.field}}});s.bar=d3.daisy.mark().type("rect").name("bar").transform(f),s.bar.enter({x:{field:b.field,scale:r.x},y:{field:c.field,scale:r.yBar},width:{scale:r.x,band:!0},height:{field:c.field,scale:r.yBar,mult:-1,offset:r.yBar.range()[0]}}).update({fill:{value:c.field,scale:r.c}}).hover({fill:{value:x.hoverColor()}}),k.mark(s.bar),s.line=d3.daisy.mark().type("line").name("line").transform(g),s.line.enter({x:{field:b.field,scale:r.x,offset:.5*r.x.bandwidth()},y:{field:d.field,scale:r.yLine},strokeWidth:e.range[0]+"px",strokeLinejoin:"round",fill:"none",curve:q.curve}).update({stroke:{value:d.field,scale:r.c}}),k.mark(s.line),s.point=d3.daisy.mark().type("circle").name("point").transform(g),s.point.enter({x:{field:b.field,scale:r.x,offset:.5*r.x.bandwidth()},y:{field:d.field,scale:r.yLine},r:{value:1.5*e.range[0]}}).update({fill:{value:d.field,scale:r.c},fillOpacity:{value:q.point?1:0}}).hover({fillOpacity:{value:1}}),k.mark(s.point),x.label()&&(s.labelBar=a(b,c,f,!0),k.mark(s.labelBar),s.labelLine=a(b,d,g,!1),k.mark(s.labelLine))}function h(){var a=x.axes();if(a){var b=p[0].field,c=o[0].field,d=o[1].field,e=a.filter(x.isXAxis);e.length>0&&(t.x=x.axisBase(e[0],r.x,b).y("height"),k.axis(t.x));var f=a.filter(x.isYAxis);if(f.length>0){var g={orient:"y-bar"},h={orient:"y-line"};x.axis(g).axis(h),t.yBar=x.axisBase(g,r.yBar,c).orient("left"),k.axis(t.yBar),t.yLine=x.axisBase(h,r.yLine,d).x("width").orient("right"),k.axis(t.yLine)}else(f=a.filter(function(a){return"y-bar"===a.orient})).length>0&&(t.yBar=x.axisBase(f[0],r.yBar,c).orient("left"),k.axis(t.yBar)),(f=a.filter(function(a){return"y-line"===a.orient})).length>0&&(t.yBar=x.axisBase(f[0],r.yLine,d).x("width").orient("right"),k.axis(t.yBar))}}function i(){if(x.tooltip()){var a=d3.daisy.tooltip();a.keyField(p[0]).valueField(o[0].field),a.update({x:{field:p[0].field,scale:r.x},y:{field:o[0].field,scale:r.yBar}}),k.tooltip(a),s.bar.on("mouseenter.tooltip",function(b){a.show(d3.select(this))}),s.bar.on("mouseleave.tooltip",function(b){a.hide(d3.select(this))});var b=d3.daisy.tooltip();b.keyField(p[0]).valueField(o[1].field),b.update({x:{field:p[0].field,scale:r.x,offset:.5*r.x.bandwidth()+8},y:{field:o[1].field,scale:r.yLine}}),k.tooltip(b),s.point.on("mouseenter.tooltip",function(a){b.show(d3.select(this))}),s.point.on("mouseleave.tooltip",function(a){b.hide(d3.select(this))})}}function j(){m&&m.scale(r.c)}var k,l,m,n,o,p,q={point:!1,curve:null,padding:.05},r={},s={},t={},u=["normal"],v={range:[2,2],scale:"linear",reverse:!1},w=d3.daisy.default.schemeCategory10(),x=d3.daisy.layout.default();return a(),d3.daisy.utils.setAttrDefaultFuncs(x,q),x};